#! /bin/bash
set -eu
# 查找利用liblzma的sshd路径
path="$(ldd $(which sshd) | grep liblzma | grep -o '/[^ ]*')"


# 检验调用路径是否存在
if [ "$path" == "" ]
then
  echo "XZ-CVE-2024-3094漏洞不存在"
  exit
fi


# 检验函数签名
if hexdump -ve '1/1 "%.2x"' "$path" | grep -q f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410
then
  echo "XZ-CVE-2024-3094漏洞存在"
else
  echo "XZ-CVE-2024-3094漏洞不存在"
fi